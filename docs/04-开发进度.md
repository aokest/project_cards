# 开发进度与过程日志

## 2025-12-25: 全面重构与功能完备（每日总结）

### 🌟 今日里程碑
本日完成了从“单页原型”到“生产级应用”的跨越。不仅解决了严重的交互稳定性问题（白屏、点击失效），还完善了数据流转逻辑，并提升了 UI 质感。

### 🚀 核心功能更新 (Late Night Updates)
1.  **数据逻辑修复 (Critical)**：
    *   **身份追踪 (`activeCardId`)**：修复了“修改项目编号/名称导致新建卡片”的逻辑漏洞。现在系统通过内部 ID 追踪卡片，支持随意重命名项目。
    *   **实时同步**：修改卡片名称后，左侧控制台下拉框会立即更新，无需刷新。
2.  **文件导入/导出**：
    *   **Markdown 批量导入**：新增 `.md` 文件解析器，支持自动识别“项目名称：”、“项目目标：”等键值对，批量生成卡片。
    *   **样式持久化**：卡片的个性化设置（字体大小、模块高度、主题色）现在会随卡片数据一起存入数据库。
3.  **时间表联动控制**：
    *   **启用/禁用机制**：在首页列表和卡片页增加了“启用/禁用”开关。禁用的卡片将自动从 Timeline 时间表中隐藏，方便管理废弃或暂缓的项目。
4.  **UI/UX 最终打磨**：
    *   **紧凑布局**：将模块间距从 `gap-8` 优化为 `gap-5`，提升屏幕利用率。
    *   **排版优化**：标题字号调至 18px，行间距优化至 1.35，预算模块底色定制为莫兰迪色 (#C5AA99)。

---

### ⚠️ 遇到的重大问题与复盘 (早些时候)

#### 1. "所需支持" 复选框无法点选/文本无法选中
- **现象**：用户点击“所需支持”模块时，要么没反应，要么无法勾选复选框。
- **根本原因**：代码结构不一致。该模块被包裹在一个额外的 `div` 中，且该 `div` 绑定了与其子元素冲突的 `onClick` 事件。
- **解决方案**：**组件化重构**。废弃硬编码 HTML，创建统一的 `<CardSection />` 组件，标准化 9 个模块的渲染逻辑。

#### 2. 页面白屏 / "一跳就崩"
- **现象**：用户点击页面任意位置，或刷新页面后，页面直接变白。
- **根本原因**：`lucide-react` 图标库直接操作 DOM 导致 React 虚拟 DOM 树同步失败。
- **解决方案**：**防御性编程**。重写 `Icon` 组件，移除全局依赖，改为手动管理 SVG 字符串注入，并包裹 `try-catch`。

#### 3. Timetable 数据不同步
- **现象**：卡片修改时间后，时间表不更新。
- **解决方案**：**双向同步**。在卡片页增加“同步数据库”按钮，显式触发后端保存；时间表页支持手动覆盖时间。

### 📝 开发经验总结
- **组件化是王道**：当 UI 问题反复出现时，不要打 CSS 补丁，直接重构组件。
- **ID 优于 Name**：永远不要用用户可编辑的字段（如“项目编号”）作为数据主键。引入 `uuid` 或 `timestamp` 作为内部 ID。
- **防御性渲染**：第三方库（图标、编辑器）必须隔离，防止其崩溃拖垮整个页面。

## 2024-12-24: 列表视图与数据管理增强
(保留历史记录...)
