# 数据模型与接口规范

## 1. 设计原则
为了支持未来的多项目管理和 CRM 融合，数据结构需从“单一卡片列表”升级为“项目-卡片”层级结构。

## 2. 核心实体定义

### 2.1 Project (项目/项目集)
代表一个宏观的项目或商机，包含多个具体的任务卡片或阶段卡片。

```json
{
  "id": "PROJ-UUID",
  "name": "2025年度安全建设规划",
  "code": "1205-S1",
  "description": "...",
  "status": "active", // active, archived
  "budgetSummary": {
    "total": 1000000,
    "currency": "CNY"
  },
  "cards": ["CARD-UUID-1", "CARD-UUID-2"], // 关联的卡片ID
  "meta": {
    "crmId": "CRM-001", // 关联外部系统ID
    "owner": "张三"
  },
  "createdAt": "2024-12-24T10:00:00Z",
  "updatedAt": "2024-12-24T10:00:00Z"
}
```

### 2.2 Card (项目卡片)
现有的卡片数据结构，作为 Project 的子集。

```json
{
  "id": "CARD-UUID",
  "projectId": "PROJ-UUID", // 归属项目
  "cardId": "1205-S1-S01", // 显示编号
  "title": "泄露情报监控",
  "rawText": "...", // 原始 Markdown 内容
  "parsedData": { ... }, // 缓存的解析数据
  "config": {
    "themeColor": "#0f172a",
    "layout": { ... },
    "section": { ... }
  },
  "aiConfig": { ... }, // 卡片级 AI 配置（可选）
  "updatedAt": "..."
}
```

## 3. 存储方案 (LocalStorage)
目前采用 LocalStorage 存储，Key 命名规范：

- `pcg_system_config`: 全局配置（含 AI 设置）
  ```json
  {
    "ai": {
      "provider": "openai",
      "baseUrl": "...",
      "model": "gpt-4o",
      "apiKey": "sk-..."
    }
  }
  ```
- `pcg_projects`: 项目列表
- `pcg_cards`: 卡片列表（扁平存储，通过 projectId 索引）

## 4. 导入导出规范
- **导出**：支持标准 JSON 格式，包含 `version`, `projects`, `cards` 三部分。
- **导入**：自动识别 JSON 版本，增量合并或覆盖。

## 5. 接口预留 (Future)
- `GET /api/v1/projects`: 获取项目列表
- `POST /api/v1/ai/refine`: 服务端 AI 代理接口（解决前端跨域或 Key 安全问题）
