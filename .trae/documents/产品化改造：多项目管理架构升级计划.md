# 产品化改造：多项目管理架构升级

## 1. 核心目标
从“单列表卡片管理”升级为“多项目层级管理”，建立 `项目 (Project) -> 卡片 (Cards)` 的两级架构，并引入丰富的项目元数据（合同、预算、团队等）。

## 2. 数据模型设计 (Schema)
新增 `projects.json` 存储项目级数据，与现有的 `project_cards.json` 关联。

### 新增：项目对象 (Project)
```json
{
  "id": "UUID或客户-项目代号",
  "meta": {
    "projectNo": "项目编号",
    "contractNo": "合同编号",
    "customerNo": "客户编号",
    "name": "项目名称"
  },
  "team": {
    "sales": "销售负责人",
    "service": "交付负责人",
    "product": "产品负责人"
  },
  "finance": {
    "budgetIncome": "收入预算",
    "budgetCost": "成本预算",
    "currency": "CNY"
  },
  "timeline": {
    "start": "YYYY-MM",
    "end": "YYYY-MM"
  },
  "deliverables": [ // 货架清单
    { "name": "产品/服务名称", "type": "标准/定开", "count": 1 }
  ],
  "content": { // 基础信息
    "goals": "项目目标",
    "scope": "项目内容",
    "analysis": "现状分析"
  },
  "cardIds": [] // 关联的卡片ID列表 (可选，或通过编号前缀自动关联)
}
```

## 3. 后端改造 (server.py)
保持现有 `/api/cards` 不变，新增项目管理接口：
- `GET /api/projects`: 获取项目列表
- `POST /api/projects`: 保存/更新项目数据
- **数据安全**：确保操作的是 `projects.json`，不影响现有的 `project_cards.json`。

## 4. 前端界面开发
### A. 新增：项目看板 (projects.html)
- 作为新的系统入口（或管理入口）
- 展示项目列表（卡片式或表格），显示关键指标（预算、进度、负责人）
- 提供“新建项目”入口

### B. 新增：项目详情页 (project_detail.html)
- **基本信息区**：展示/编辑合同、客户、团队、预算等元数据
- **货架清单区**：管理交付物列表
- **关联卡片区**：
  - 自动筛选属于该项目的卡片（基于编号规则 `客户-项目-*`）
  - 提供“新增卡片”按钮，自动携带项目编号前缀跳转到 `cardv8.html`

### C. 优化：卡片编辑器 (cardv8.html)
- 增加“关联项目”上下文
- 若 URL 包含 `?projectId=...`，自动填充编号前缀
- 在控制台增加“查看项目详情”链接

## 5. 实施步骤
1.  **后端升级**：修改 `server.py` 支持 projects 读写，创建空的 `projects.json`。
2.  **创建项目看板**：开发 `projects.html`。
3.  **创建项目详情**：开发 `project_detail.html`，实现元数据录入与卡片列表展示。
4.  **联调与验证**：创建一个测试项目，验证元数据保存及卡片关联流程。
5.  **文档更新**：更新开发规范与功能说明。

## 6. 兼容性说明
- 现有 `index.html` 和 `project_cards.json` 均保留，旧数据不受影响。
- 新功能作为“上层建筑”叠加在现有功能之上。

请确认是否按此架构进行开发？确认后我将开始代码实现。